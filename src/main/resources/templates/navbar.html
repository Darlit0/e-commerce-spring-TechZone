<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <title>Navbar</title>
    <link th:href="@{/css/navbar.css}" rel="stylesheet">
</head>
<body>
    <nav th:fragment="navbar" class="navbar">
        <div class="navbar-container">
            <button class="navbar-toggle" onclick="toggleMenu()">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="3" y1="6" x2="21" y2="6"></line>
                    <line x1="3" y1="12" x2="21" y2="12"></line>
                    <line x1="3" y1="18" x2="21" y2="18"></line>
                </svg>
            </button>

            <a class="navbar-brand-centered" th:href="@{/index}">
                TechZone
            </a>

            <div class="navbar-content" id="navbarContent">
                <div class="navbar-actions">
                    <div sec:authorize="isAuthenticated()">
                        <a th:href="@{/panier}" class="btn-navbar">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="9" cy="21" r="1"></circle>
                                <circle cx="20" cy="21" r="1"></circle>
                                <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
                            </svg>
                            Panier
                        </a>
                    </div>
                    <div sec:authorize="isAnonymous()">
                        <a th:href="@{/login}" class="btn-navbar">
                            Connexion
                        </a>
                    </div>

                    <div class="dropdown" sec:authorize="isAuthenticated()">
                        <button class="dropdown-toggle" onclick="toggleDropdown(event)">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                <circle cx="12" cy="7" r="4"></circle>
                            </svg>
                            <span sec:authentication="name">Utilisateur</span>
                        </button>

                        <ul class="dropdown-menu" id="userDropdown">
                            <li>
                                <a class="dropdown-item" th:href="@{/profil}">
                                    Mon Profil
                                </a>
                            </li>
                            <li sec:authorize="hasRole('ADMIN')">
                                <a class="dropdown-item" th:href="@{/admin/dashboard}">
                                    Admin Dashboard
                                </a>
                            </li>
                            <li><hr class="dropdown-divider"></li>
                            <li>
                                <form th:action="@{/logout}" method="post" style="margin: 0;">
                                    <button type="submit" class="dropdown-item text-danger">
                                        DÃ©connexion
                                    </button>
                                </form>
                            </li>
                        </ul>
                    </div>
                </div>

            </div>
        </div>
    </nav>
    
    <script>
        function toggleMenu() {
            const content = document.getElementById('navbarContent');
            content.classList.toggle('active');
        }
        
        function toggleDropdown(event) {
            event.stopPropagation();
            const dropdown = document.getElementById('userDropdown');
            dropdown.classList.toggle('show');
        }
        
        document.addEventListener('click', function() {
            const dropdown = document.getElementById('userDropdown');
            if (dropdown) {
                dropdown.classList.remove('show');
            }
        });
    </script>
</body>
</html>


