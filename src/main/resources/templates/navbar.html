<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <title>Navbar</title>
    <link th:href="@{/css/navbar.css}" rel="stylesheet">
</head>
<body>
    <nav th:fragment="navbar" class="navbar">
        <div class="navbar-container">
            <a class="navbar-brand" th:href="@{/index}">
                TechZone
            </a>

            <button class="navbar-toggle" onclick="toggleMenu()">â˜°</button>

            <div class="navbar-content" id="navbarContent">
                
                <ul class="navbar-nav">
                    <li class="nav-item" sec:authorize="hasRole('ADMIN')">
                        <a class="nav-link" th:href="@{/admin/dashboard}">
                            Admin Dashboard
                        </a>
                    </li>
                </ul>
                
                <div class="navbar-actions">
                    
                    <div sec:authorize="isAuthenticated()">
                        <a th:href="@{/panier}" class="btn-navbar">
                            ðŸ›’ Panier
                        </a>
                    </div>
                    
                    <div sec:authorize="isAnonymous()">
                        <a th:href="@{/login}" class="btn-navbar">
                            Connexion
                        </a>
                    </div>

                    <div class="dropdown" sec:authorize="isAuthenticated()">
                        <button class="dropdown-toggle" onclick="toggleDropdown(event)">
                            ðŸ‘¤ <span sec:authentication="name">Utilisateur</span>
                        </button>

                        <ul class="dropdown-menu" id="userDropdown">                            
                            <li>
                                <a class="dropdown-item" th:href="@{/profil}">
                                    Mon Profil
                                </a>
                            </li>
                            
                            <li><hr class="dropdown-divider"></li>
                            
                            <li>
                                <form th:action="@{/logout}" method="post" style="margin: 0;">
                                    <button type="submit" class="dropdown-item text-danger">
                                        DÃ©connexion
                                    </button>
                                </form>
                            </li>
                        </ul>
                    </div>
                </div>

            </div>
        </div>
    </nav>
    
    <script>
        function toggleMenu() {
            const content = document.getElementById('navbarContent');
            content.classList.toggle('active');
        }
        
        function toggleDropdown(event) {
            event.stopPropagation();
            const dropdown = document.getElementById('userDropdown');
            dropdown.classList.toggle('show');
        }
        
        // Close dropdown when clicking outside
        document.addEventListener('click', function() {
            const dropdown = document.getElementById('userDropdown');
            if (dropdown) {
                dropdown.classList.remove('show');
            }
        });
    </script>
</body>
</html>


